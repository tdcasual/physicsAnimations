# 安全说明与上线建议

本项目默认面向轻量自托管场景。下面是当前已实现的安全措施和上线建议。

## 当前已实现

1. 预览隔离
- 预览页 iframe 使用最小化 `sandbox`
- 设置 `referrerpolicy="no-referrer"`

2. 上传内容处理
- 支持单 HTML 与 ZIP 上传
- 对外部 JS/CSS 依赖进行受控下载与本地改写
- 仅允许公共 `http(s)` 资源，限制数量与大小

3. SSRF 防护
- 截图网络请求会阻止访问 localhost/私网段/`.local` 等地址

4. 鉴权与限流
- 管理类接口要求管理员登录
- 登录、写入、截图、任务重试均有基础限流

5. 任务可观测
- 截图与异步任务支持状态查询和重试
- 任务状态可持久化，降低重启造成的状态丢失

## 上线建议（务实版）

1. 改默认管理员账号
- 不要继续使用 `admin/admin`
- 优先配置 `ADMIN_PASSWORD_HASH` 而不是明文密码

2. 配置稳定的 JWT 密钥
- 生产环境务必设置 `JWT_SECRET`

3. 收紧指标接口
- 如需限制运行指标暴露，设置 `METRICS_PUBLIC=false`

4. 确保持久化目录可靠
- Docker/Compose 场景挂载 `content/`
- Serverless 场景优先使用 WebDAV

5. 公网部署时额外加固
- 在反向代理层增加访问控制
- 启用 HTTPS
- 结合实际场景补充审计和备份策略

## 风险边界

这是一个单管理员模型的内容管理服务，不是多租户 CMS。若你计划公网长期运行，建议在以下方面继续增强：

- 细粒度权限
- 审计日志
- 上传内容安全扫描
- 更严格的资源访问策略
